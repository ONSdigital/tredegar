!function(){function GeneralConfiguration($locationProvider,$httpProvider,$logProvider){$locationProvider.html5Mode(!1).hashPrefix("!"),$logProvider.debugEnabled(onsAlphaConfiguration.debugEnabled)}function RunConfiguration($location,$http,$rootScope,$routeParams,DSCacheFactory,$cacheFactory,$log){function configureGoogleAnalytics(){$rootScope.$on("$routeChangeSuccess",function(){var path=$location.path(),searchTerm=$routeParams.searchTerm;searchTerm&&(path+="?q="+searchTerm),ga("send","pageview",path),$log.debug("Google Analytics pageview sent :",path)})}function configureCache(){function getAngularCache(){function getItem(key){return cache.get(key)}function setItem(key,value){return cache.put(key,value)}function removeItem(key){cache.remove(key)}var cache=$cacheFactory("dataCache");return localStoragePolyfill={getItem:getItem,setItem:setItem,removeItem:removeItem}}function hasLocalStorage(){try{if(window.localStorage)return!0}catch(err){$log.warn("Failed detecting local storage, disabling local storage cache")}return!1}$log.info("Configuring data cache");var options={maxAge:18e5,cacheFlushInterval:108e5,deleteOnExpire:"aggressive",storageMode:"localStorage"};hasLocalStorage()||($log.warn("Local storage not supported, using angular cache"),options.storageImpl=getAngularCache());var dataCache=DSCacheFactory("dataCache",options);"localhost"===$location.host()&&onsAlphaConfiguration.disableCacheOnLocal||($http.defaults.cache=dataCache)}$rootScope.onsAlphaConfiguration=onsAlphaConfiguration,configureCache(),configureGoogleAnalytics()}var onsAlphaConfiguration={disableCacheOnLocal:!0,defaultTimeseriesCountOnT3:5,autoCompleteLimit:5,debugEnabled:!1};angular.module("onsAppConfig",[]).config(["$locationProvider","$httpProvider","$logProvider",GeneralConfiguration]).run(["$location","$http","$rootScope","$routeParams","DSCacheFactory","$cacheFactory","$log",RunConfiguration])}(),function(){"use strict";function MainController($scope,PageUtil,$rootScope){$scope.scrollTo=function(id){PageUtil.scrollTo(id)},$scope.getPath=function(){return PageUtil.getPath()},$scope.getPage=function(){return PageUtil.getPage()},$scope.getUrl=function(){return PageUtil.getUrl()},$scope.getTitle=function(){return PageUtil.getTitle()},$scope.hasErrors=function(){return $rootScope.error?!0:!1}}function run($rootScope,DataLoader,PageUtil,$window){redirectCheck(PageUtil,$window),loadNavigation($rootScope,DataLoader)}function redirectCheck(PageUtil,$window){var absoluteLocation=PageUtil.getAbsoluteUrl();-1!=absoluteLocation.indexOf("?onsfb")?(absoluteLocation=absoluteLocation.replace("?onsfb","#!"),$window.location.href=absoluteLocation):-1===absoluteLocation.indexOf("#!/")&&PageUtil.goToPage("/")}function loadNavigation($rootScope,DataLoader){DataLoader.load("/navigation").then(function(data){$rootScope.onsNavigation=data})}var onsApp=(angular.module("onsComponents",["onsAccordion","onsNavigation","onsPaginator","onsTabs","highcharts-ng","angularLoadingBar","onsToggler","onsLoading","onsSparkline","onsTooltip","onsAutocomplete","onsDoubleTap"]),angular.module("onsHelpers",["onsFilters","onsTaxonomy","onsDownloader","onsUtils","onsDataLoader","angular-data.DSCacheFactory"]),angular.module("onsTemplates",[]),angular.module("onsApp",["ngRoute","ngSanitize","ipCookie","onsComponents","onsHelpers","onsTemplates","onsAppConfig"]));onsApp.run(["$rootScope","DataLoader","PageUtil",run]).controller("MainCtrl",["$scope","PageUtil","$rootScope",MainController])}(),function(){"use strict";function RotueConfigration($routeProvider,$locationProvider,$httpProvider){function resolveTaxonomyTemplate(){var routeConfig={resolve:{data:["Taxonomy","PageUtil",function(Taxonomy,PageUtil){var promise=Taxonomy.loadData();return promise.then(function(data){PageUtil.setTitle(data.name)}),promise}]},templateUrl:"app/templates/taxonomy/taxonomy.html",controller:"TaxonomyController",controllerAs:"taxonomy"};return routeConfig}function resolveSearch(){var routeConfig={resolve:{searchResponse:["PageUtil","DataLoader","$route",search],title:["PageUtil",function(PageUtil){PageUtil.setTitle("Search Results")}]},templateUrl:"app/templates/search-results/search-results.html",controller:"SearchController"};return routeConfig}function search(PageUtil,DataLoader,$route){var params=$route.current.params,q=params.searchTerm,type=params.type,pageNumber=params.page,searchString="?q="+q+(pageNumber?"&page="+pageNumber:"")+getTypesString(type);return DataLoader.load("/search"+searchString).then(function(data){return data.type&&"timeseries"===data.type?void PageUtil.goToPage(data.uri,!0):data},function(){console.log("Failed loading search results")})}function getTypesString(type){if(!type)return"";if("string"==typeof type)return"&type="+type;for(var typeString="",i=0;i<type.length;i++)typeString+="&type="+type[i];return typeString}$routeProvider.when("/aboutus",{templateUrl:"app/templates/about/aboutus.html",controller:"AboutCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("About")}]}}).when("/accessibility",{templateUrl:"app/templates/accessibility/accessibility.html",controller:"AccessibilityCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Accessibility")}]}}).when("/alpha",{templateUrl:"app/templates/alphapage/alphapage.html",controller:"AlphaPageCtlr",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Protoype")}]}}).when("/calendar",{templateUrl:"app/templates/calendar/calendar.html",controller:"CalendarCtlr",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Release Calendar")}]}}).when(":collectionPath*/collection",{templateUrl:"app/templates/collection/collection.html",controller:"CollectionCtrl",controllerAs:"collection",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Collections")}]}}).when("/contactus",{templateUrl:"app/templates/contact/contactus.html",controller:"ContactUsCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Contact Us")}]}}).when("/copyright",{templateUrl:"app/templates/copyright/copyright.html",controller:"CopyrightCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Copyright")}]}}).when("/dataversions",{templateUrl:"app/templates/dataversions/dataversions.html",controller:"DataversionsCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Data Versions")}]}}).when("/localstats",{templateUrl:"app/templates/localstats/localstats.html",controller:"LocalStatsCtlr",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Local Statistics")}]}}).when("/methodology",{templateUrl:"app/templates/methodology/methodology.html",controller:"MethodologyCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Methodology")}]}}).when("/nationalstats",{templateUrl:"app/templates/nationalstats/nationalstats.html",controller:"NationalStatsCtlr",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("National Statistics")}]}}).when("/previous",{templateUrl:"app/templates/previoustatic/previoustatic.html",controller:"PreviousCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Previous Versions")}]}}).when("/privacy",{templateUrl:"app/templates/privacy/privacy.html",controller:"PrivacyCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Privacy")}]}}).when("/search/:searchTerm?",resolveSearch()).when("/search/:searchTerm/page/:page",resolveSearch()).when("/survey",{templateUrl:"app/templates/survey/survey.html",controller:"SurveyCtrl",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("Survey")}]}}).when("/404",{templateUrl:"/app/templates/error-pages/error404.html",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("404")}]}}).when("/500",{templateUrl:"/app/templates/error-pages/error500.html",resolve:{title:["PageUtil",function(PageUtil){PageUtil.setTitle("500")}]}}).otherwise(resolveTaxonomyTemplate()),$httpProvider.responseInterceptors.push("OnsHttpInterceptor")}function OnsHttpInterceptor($q,$rootScope){function watchLocation(){$rootScope.$on("$locationChangeStart",function(){delete $rootScope.error})}return watchLocation(),function(promise){return promise.then(function(response){return response},function(response){return 500===response.status&&($rootScope.error=500),404===response.status&&($rootScope.error=404),$q.reject(response)})}}angular.module("onsApp").config(["$routeProvider","$locationProvider","$httpProvider",RotueConfigration]).factory("OnsHttpInterceptor",["$q","$rootScope",OnsHttpInterceptor])}(),function(){"use strict";function TaxonomyService($log,$location,$q,DataLoader,StringUtil,ArrayUtil){function loadData(){return DataLoader.load(resolvePath())}function loadItem(item){if(item){var path=dataPath+item.uri;return DataLoader.load(path).then(function(itemData){return item.data=itemData,itemData})}}function resolveChartData(timeseries){if(timeseries){var chartData,data=timeseries.data;if(ArrayUtil.isNotEmpty(data.years))chartData=data.years;else if(ArrayUtil.isNotEmpty(data.quarters))chartData=data.quarters;else{if(!ArrayUtil.isNotEmpty(data.months))return void $log.error("No timeseries data found for ",timeseries.name);chartData=data.months}return chartData}}function resolvePath(){var path=$location.$$path;return path=StringUtil.endsWith(path,"/")?path:path+"/",path=dataPath+path}var service=this,dataPath="/data";angular.extend(service,{loadData:loadData,loadItem:loadItem,resolveChartData:resolveChartData})}angular.module("onsTaxonomy",[]).service("Taxonomy",["$log","$location","$q","DataLoader","StringUtil","ArrayUtil",TaxonomyService])}(),function(){"use strict";function Downloader($http,$log){function downloadFile(downloadRequest,filename){$http.post("download",downloadRequest,{responseType:"arraybuffer"}).success(function(data,status,headers){var octetStreamMime="application/octet-stream",success=!1;headers=headers();var contentType=headers["content-type"]||octetStreamMime;try{$log.debug("Downloader: Trying saveBlob method ...");var blob=new Blob([data],{type:contentType});if(navigator.msSaveBlob)navigator.msSaveBlob(blob,filename);else{var saveBlob=navigator.webkitSaveBlob||navigator.mozSaveBlob||navigator.saveBlob;if(void 0===saveBlob)throw"Not supported";saveBlob(blob,filename)}$log.debug("saveBlob succeeded"),success=!0}catch(ex){$log.error("saveBlob method failed with the following exception:"),$log.error(ex)}if(!success){var urlCreator=window.URL||window.webkitURL||window.mozURL||window.msURL;if(urlCreator){var link=document.createElement("a");if("download"in link)try{$log.debug("Trying download link method with simulated click ...");var blob=new Blob([data],{type:contentType}),url=urlCreator.createObjectURL(blob);link.setAttribute("href",url),link.setAttribute("download",filename);var event=document.createEvent("MouseEvents");event.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),link.dispatchEvent(event),$log.debug("Download link method with simulated click succeeded"),success=!0}catch(ex){$log.error("Download link method with simulated click failed with the following exception:"),$log.error(ex)}if(!success)try{$log.debug("Trying download link method with window.location ...");var blob=new Blob([data],{type:octetStreamMime}),url=urlCreator.createObjectURL(blob);window.location=url,$log.debug("Download link method with window.location succeeded"),success=!0}catch(ex){$log.error("Download link method with window.location failed with the following exception:"),$log.error(ex)}}}success||($log.debug("No methods worked for saving the arraybuffer, using last resort window.open"),window.open("/download","_blank",""))}).error(function(data,status){$log.error("Request failed with status: "+status)})}var downloader=this;angular.extend(downloader,{downloadFile:downloadFile})}angular.module("onsDownloader",[]).service("Downloader",["$http","$log",Downloader])}(),function(){"use strict";function DataLoader($rootScope,$http,$log,$q,DSCacheFactory,$location){function load(path){var deferred,cachedData=loadFromCache(path);return cachedData?($log.debug("Data Loader : Cached data hit for ",path," ",cachedData.data),deferred=$q.defer(),deferred.resolve(cachedData.data),deferred.promise):$http.get(path,{cache:!1}).then(function(data){return $log.debug("Data Loader : Successfully loaded data at ",path," ",data.data),storeToCache(path,data),data.data},function(err){throw $log.error("Data Loader : Failed loading data at "),$log.error(err),err})}function storeToCache(path,data){try{if("localhost"===$location.host()&&$rootScope.onsAlphaConfiguration.disableCacheOnLocal)return;cache.put(path,data)}catch(err){$log.error("Failed storing data to cache: ["+err+"]")}}function loadFromCache(key){var data;if("localhost"!==$location.host()||!$rootScope.onsAlphaConfiguration.disableCacheOnLocal)return data=cache.get(key)}function loadPost(path,requestData,options){$log.debug("Data Loader Post: Loading data at ",path," ,requesting ",requestData);var deferred=$q.defer();return $http.post(path,requestData,options).success(function(data){$log.debug("Data Loader Post: Successfully loaded data at ",path," ",data),deferred.resolve(data)}).error(function(err){$log.error("Data Loader Post : Failed loading data at "+path),deferred.resolve(err)}),deferred.promise}var dataLoader=this,cache=DSCacheFactory.get("dataCache");angular.extend(dataLoader,{load:load,loadPost:loadPost})}angular.module("onsDataLoader",[]).service("DataLoader",["$rootScope","$http","$log","$q","DSCacheFactory","$location",DataLoader])}(),function(){"use strict";function TaxonomyController($scope,data){function prepareBreadcrumb($scope,data){"t1"!==data.level&&($scope.breadcrumb={},$scope.breadcrumb.parent=data.breadcrumb,$scope.breadcrumb.current=data.name)}var taxonomy=this;taxonomy.data=data,prepareBreadcrumb($scope,data)}function T1ChartController($scope,Chart){var t1=($scope.item.data,this);$scope.item.data?Chart.buildChart(t1,$scope.item.data,!1):$scope.$watch("item.data",function(){Chart.buildChart(t1,$scope.item.data,!1)})}angular.module("onsTemplates").controller("TaxonomyController",["$scope","data",TaxonomyController]).controller("T1ChartController",["$scope","Chart",T1ChartController])}(),function(){"use strict";function T1Controller($scope,$window,Taxonomy){function initialize(){for(var i=0;i<sections.length;i++)for(var j=0;j<sections[i].items.length;j++)loadItemData(sections[i].items[j])}function loadItemData(item){Taxonomy.loadItem(item).then(function(){item.chartData=Taxonomy.resolveChartData(item)},handleDataLoadError)}function handleDataLoadError(){}var t1=this,sections=$scope.taxonomy.data.sections;t1.sparklineHeight=50,t1.sparklineWidth=120,initialize()}angular.module("onsTemplates").controller("T1Controller",["$scope","$window","Taxonomy",T1Controller])}(),function(){angular.module("onsTemplates").controller("T2Ctrl",["$scope",function($scope){function convertToTable(children){for(var result=[],index=0,length=children.length,i=0;length>i;i+=3)result[index]=[],result[index][0]=children[i],length>i+1&&(result[index][1]=children[i+1]),length>i+2&&(result[index][2]=children[i+2]),index++;return result}var lastSection={nondata:!0};$scope.taxonomy.data.sections.push(lastSection),$scope.taxonomy.data.sections=convertToTable($scope.taxonomy.data.sections)}])}(),function(){"use strict";function T3Controller($rootScope,$scope,Taxonomy){function initialize(){loadItem(data.headline),t3.loadedTimseriesCount--,loadItem(data.statsBulletinHeadline),loadItems(data.items,t3.timeseriesDefaultLimit),loadItems(data.statsBulletins),loadItems(data.datasets)}function loadItems(items,limit){limit=limit||items.length,limit=limit>items.length?items.length:limit;for(var i=0;limit>i;i++)loadItem(items[i])}function loadItem(item){var promise=Taxonomy.loadItem(item);promise&&promise.then(function(data){"timeseries"===data.type&&(t3.loadedTimseriesCount++,hasMore()||(loadingMore=!1,t3.allVisible=!0),item.chartData=Taxonomy.resolveChartData(item))},handleDataLoadError)}function handleDataLoadError(item){item.data=[],item.failed=!0}function isLoading(){return loadingMore}function hasMore(){return timeseriesCount>t3.loadedTimseriesCount}function toggleTimeSeries(){var more=hasMore();return t3.allVisible?(t3.allVisible=!1,void $scope.scrollTo("timeseries")):(t3.allVisible=!0,void(more&&(loadingMore=!0,loadItems(data.items.slice(t3.loadedTimseriesCount)))))}var t3=this,data=$scope.taxonomy.data,timeseriesCount=data.items.length;t3.timeseriesDefaultLimit=$rootScope.onsAlphaConfiguration.defaultTimeseriesCountOnT3,t3.loadedTimseriesCount=0,t3.allVisible=!1,t3.showToggle=timeseriesCount>t3.timeseriesDefaultLimit;var loadingMore=!1;initialize(),angular.extend(t3,{isLoading:isLoading,toggleTimeSeries:toggleTimeSeries})}angular.module("onsTemplates").controller("T3Controller",["$rootScope","$scope","Taxonomy",T3Controller])}(),function(){function T5Controller($scope,$log,Downloader,DataLoader){function downloadXls(){download("xlsx")}function downloadCsv(){download("csv")}function download(type){var downloadRequest={type:type};downloadRequest.uriList=[$scope.getPath()];var fileName=$scope.getPage()+"."+downloadRequest.type;Downloader.downloadFile(downloadRequest,fileName)}function loadRelatedBulletins(data){var dataPath="/data",bulletins=data.relatedBulletins;if(null!=bulletins)for(var i=0;i<bulletins.length;i++){var bulletin=bulletins[i],relatedBulletinPath=dataPath+bulletin;DataLoader.load(relatedBulletinPath).then(function(relatedBulletin){$log.debug("Loaded related bulletin: ",relatedBulletinPath," ",relatedBulletin),data.relatedBulletinData.push(relatedBulletin)})}}function loadRelatedTimeseries(data){var dataPath="/data",relatedTimeserieses=data.relatedTimeseries;if(null!=relatedTimeserieses)for(var i=0;i<relatedTimeserieses.length;i++){var timeseries=relatedTimeserieses[i],relatedTimeseriesPath=dataPath+timeseries;DataLoader.load(relatedTimeseriesPath).then(function(relatedTimeseries){$log.debug("Loaded related timeseries: ",relatedTimeseriesPath," ",relatedTimeseries),data.relatedTimeseriesData.push(relatedTimeseries)})}}var t5=this;$scope.header="Time Series",$scope.sidebar=!0,$scope.sidebarUrl="/app/templates/t5/t5sidebar.html";var data=$scope.taxonomy.data;data.relatedBulletinData=[],loadRelatedBulletins(data),data.relatedTimeseriesData=[],loadRelatedTimeseries(data),angular.extend(t5,{downloadXls:downloadXls,downloadCsv:downloadCsv})}function ChartController($scope,$location,$log,Downloader,ArrayUtil){function changeChartType(chartType){$log.debug("Changing chart type to "+chartType),ctrl.activeChart=chartType,changeTimePeriod("A")}function changeTimePeriod(timePeriod){timePeriod=timePeriod||"Custom",$log.debug("Changing time period to "+timePeriod),ctrl.timePeriod=timePeriod,prepareData()}function prepareData(){function tenYears(array){return ArrayUtil.getLast(array)-ArrayUtil.getFirst(array)<10?!1:!0}function tickInterval(length){return 20>=length?1:80>=length?4:240>=length?12:480>=length?48:960>=length?96:192}function filterValues(){var current,i,from,to,data=getAllValues(),filteredValues=[],min=0;for(from=ctrl.fromYear+(ctrl.fromQuarter?quarterVal(ctrl.fromQuarter):"")+(ctrl.fromMonth?monthVal(ctrl.fromMonth):""),to=ctrl.toYear+(ctrl.toQuarter?quarterVal(ctrl.toQuarter):"")+(ctrl.toMonth?monthVal(ctrl.toMonth):""),from=+from,to=+to,$log.debug("From: ",from),$log.debug("To: ",to),i=0;i<data.length;i++)current=data[i],current.value>=from&&current.value<=to&&(filteredValues.push(current),current.y<min&&(min=current.y));return ctrl.min=0>min?min-1:0,filteredValues}function resolveFilters(){var first=ArrayUtil.getFirst(getAllValues()),last=ArrayUtil.getLast(getAllValues()),now=new Date,currentYear=now.getFullYear(),tenYearsAgo=currentYear-10,fiveYearsAgo=currentYear-5;switch(ctrl.timePeriod){case"A":ctrl.fromYear=first.year,ctrl.fromMonth=first.month?first.month.slice(0,3):first.month,ctrl.fromQuarter=first.quarter;break;case"10":tenYearsAgo<first.year?(ctrl.fromYear=first.year,ctrl.fromMonth=first.month?first.month.slice(0,3):first.month,ctrl.fromQuarter=first.quarter):(ctrl.fromYear=""+tenYearsAgo,ctrl.fromQuarter=isActive("quarters")?"Q1":void 0,ctrl.fromMonth=isActive("months")?"Jan":void 0);break;case"5":fiveYearsAgo<first.year?(ctrl.fromYear=first.year,ctrl.fromMonth=first.month?first.month.slice(0,3):first.month,ctrl.fromQuarter=first.quarter):(ctrl.fromYear=""+fiveYearsAgo,ctrl.fromQuarter=isActive("quarters")?"Q1":void 0,ctrl.fromMonth=isActive("months")?"Jan":void 0);break;case"Custom":return}ctrl.toYear=last.year,ctrl.toMonth=last.month?last.month.slice(0,3):last.month,ctrl.toQuarter=last.quarter}ctrl.renderChart&&(resolveFilters(),ctrl.chartData=filterValues(),ctrl.chartConfig.series[0].data=ctrl.chartData,ctrl.years=getYears(),ctrl.tenYears=tenYears(ctrl.years),ctrl.chartConfig.options.xAxis.tickInterval=tickInterval(ctrl.chartData.length),ctrl.chartConfig.options.title.text=ctrl.timeseries.name,ctrl.chartConfig.options.yAxis.title.text=ctrl.timeseries.preUnit+" "+ctrl.timeseries.unit,ctrl.chartConfig.options.yAxis.min=ctrl.min,ctrl.chartConfig.subtitle.text="Source: "+ctrl.timeseries.source,$log.debug("Chart:"),$log.debug(ctrl.chartConfig),$log.debug("10y = "+ctrl.tenYears))}function isActive(chartType){return chartType===ctrl.activeChart}function getAllValues(){return ctrl.timeseries[ctrl.activeChart].values}function getYears(){return ctrl.timeseries[ctrl.activeChart].years}function initialize(){function resolveChartTypes(ArrayUtil){var data=ctrl.timeseries;ctrl.showYearly=ArrayUtil.isNotEmpty(data.years),ctrl.showMonthly=ArrayUtil.isNotEmpty(data.months),ctrl.showQuarterly=ArrayUtil.isNotEmpty(data.quarters),ctrl.showYearly&&(ctrl.activeChart="years",data.years=formatData(data.years)),ctrl.showQuarterly&&(ctrl.activeChart="quarters",data.quarters=formatData(data.quarters)),ctrl.showMonthly&&(ctrl.activeChart="months",data.months=formatData(data.months)),(ctrl.showMonthly||ctrl.showYearly||ctrl.showQuarterly)&&(ctrl.renderChart=!0)}function formatData(timeseriesValues){var current,i,data={values:[],years:[]};for(i=0;i<timeseriesValues.length;i++)current=timeseriesValues[i],data.values.push(enrichData(current,i)),data.years.push(current.year);return ArrayUtil.toUnique(data.years),data}function enrichData(timeseriesValue){var quarter=timeseriesValue.quarter,year=timeseriesValue.year,month=timeseriesValue.month;return timeseriesValue.y=+timeseriesValue.value,timeseriesValue.value=+(year+(quarter?quarterVal(quarter):"")+(month?monthVal(month):"")),timeseriesValue.name=timeseriesValue.date,delete timeseriesValue.date,timeseriesValue}resolveChartTypes(ArrayUtil),ctrl.chartConfig.series[0].name=ctrl.timeseries.name,ctrl.chartConfig.series[0].unit=ctrl.timeseries.unit,ctrl.chartConfig.series[0].preUnit=ctrl.timeseries.preUnit?ctrl.timeseries.preUnit+" ":" ",prepareData()}function monthVal(mon){switch(mon.slice(0,3).toUpperCase()){case"JAN":return"01";case"FEB":return"02";case"MAR":return"03";case"APR":return"04";case"MAY":return"05";case"JUN":return"06";case"JUL":return"07";case"AUG":return"08";case"SEP":return"09";case"OCT":return"10";case"NOV":return"11";case"DEC":return"12";default:throw"Invalid Month:"+mon}}function quarterVal(quarter){switch(quarter){case"Q1":return 1;case"Q2":return 2;case"Q3":return 3;case"Q4":return 4;default:throw"Invalid Quarter:"+quarter}}function downloadXls(){download("xlsx")}function downloadCsv(){download("csv")}function download(type){var downloadRequest={type:type,from:{year:ctrl.fromYear,month:ctrl.fromMonth,quarter:ctrl.fromQuarter},to:{year:ctrl.toYear,month:ctrl.toMonth,quarter:ctrl.toQuarter}};downloadRequest.uriList=[$scope.getPath()];var fileName=$scope.getPage()+"."+downloadRequest.type;Downloader.downloadFile(downloadRequest,fileName)}function exportImage(){var chartExp=$("#chart_prices").highcharts();chartExp.exportChart()}var ctrl=this;ctrl.timeseries=$scope.taxonomy.data,ctrl.chartConfig=getChart(),ctrl.showYearly=!1,ctrl.showMonthly=!1,ctrl.showQuarterly=!1,ctrl.activeChart="",ctrl.timePeriod="A",ctrl.chartData=[],ctrl.years=[],ctrl.renderChart=!1,ctrl.tenYears,ctrl.min,ctrl.quarters=["Q1","Q2","Q3","Q4"],ctrl.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],initialize(),changeChartType(ctrl.activeChart),angular.extend(ctrl,{isActive:isActive,changeChartType:changeChartType,changeTimePeriod:changeTimePeriod,downloadCsv:downloadCsv,downloadXls:downloadXls,exportImage:exportImage})}function getChart(){var data={options:{chart:{type:"line"},colors:["#007dc3","#409ed2","#7fbee1","#007dc3","#409ed2","#7fbee1"],title:{text:""},subtitle:{text:""},navigation:{buttonOptions:{enabled:!1}},xAxis:{categories:[],labels:{formatter:function(){var w=Math.max(document.documentElement.clientWidth,window.innerWidth||0),response="";return 768>w?(this.isFirst&&(count=0),count%3===0&&(response=this.value),count++):response=this.value,response}},tickmarkPlacement:"on"},yAxis:{title:{align:"high",rotation:0,textAlign:"left",x:10,y:-10}},credits:{enabled:!1},plotOptions:{series:{shadow:!1,states:{hover:{enabled:!0,shadow:!1,lineWidth:3,lineWidthPlus:0,marker:{height:0,width:0,halo:!1,enabled:!0,fillColor:null,radiusPlus:null,lineWidth:3,lineWidthPlus:0}}}}},tooltip:{shared:!0,width:"150px",crosshairs:{width:2,color:"#f37121"},positioner:function(labelWidth,labelHeight,point){var tooltipX,tooltipY,w=Math.max(document.documentElement.clientWidth,window.innerWidth||0),points={x:30,y:42},chart=Highcharts.charts[Highcharts.charts.length-1];return w>768?(point.plotX+labelWidth>chart.plotWidth?(tooltipX=point.plotX+chart.plotLeft-labelWidth-20,$("#custom-tooltip").removeClass("tooltip-left")):(tooltipX=point.plotX+chart.plotLeft+20,$("#custom-tooltip").removeClass("tooltip-right")),tooltipY=50,points={x:tooltipX,y:tooltipY}):($("#custom-tooltip").removeClass("tooltip-left"),$("#custom-tooltip").removeClass("tooltip-right")),points},formatter:function(){var id1='<div id="custom-tooltip" class="tooltip-left tooltip-right">',block=id1+"<div class='sidebar' >",title='<b class="title">'+this.points[0].key+": </b><br/>",symbol=['<div class="circle">●</div>','<div class="square">■</div>','<div class="diamond">♦</div>','<div class="triangle">▲</div>','<div class="triangle">▼</div>'],content=block+"<div class='title'>&nbsp;</div>";return $.each(this.points,function(i){content+=symbol[i]}),content+="</div>",content+="<div class='mainText'>",content+=title,$.each(this.points,function(i,val){content+='<div class="tiptext"><i>'+val.point.series.chart.series[i].name+"</i><br/><b>Value: "+val.point.series.chart.series[i].options.preUnit+val.y+" "+val.point.series.chart.series[i].options.unit+"</b></div>"}),content+="</div>"},backgroundColor:"rgba(255, 255, 255, 0)",borderWidth:0,borderColor:"rgba(255, 255, 255, 0)",shadow:!1,useHTML:!0}},subtitle:{text:"",floating:!0,align:"right",x:0,verticalAlign:"bottom",y:10},series:[{name:"",id:"",data:[],marker:{symbol:"circle",states:{hover:{fillColor:"#007dc3",radiusPlus:0,lineWidthPlus:0}}},dashStyle:"Solid"}]};return data}angular.module("onsTemplates").controller("T5Controller",["$scope","$log","Downloader","DataLoader",T5Controller]).controller("ChartController",["$scope","$location","$log","Downloader","ArrayUtil",ChartController])}(),function(){angular.module("onsTemplates").controller("T6Ctrl",["$scope",function($scope){$scope.header="Time Series",$scope.contentType="timeseries",$scope.sidebar=!0,$scope.sidebarUrl="app/templates/t6/t6sidebar.html"}]).controller("GoogleChartCtrl",["$scope","$location","$http",function($scope,$location,$http){function getTable(path,callback){$http.get(path).success(callback)}getTable("/googlechart.json",function(data){$scope.chart=data})}])}(),function(){"use strict";function SearchController($scope,$rootScope,$window,$log,PageUtil,StringUtil,searchResponse,$routeParams){function initialize(q,type){$scope.pageCount=Math.ceil(searchResponse.contentSearchResult.numberOfResults/10),$scope.totalCount=searchResponse.contentSearchResult.numberOfResults,searchResponse.homeSearchResult&&($scope.totalCount+=searchResponse.homeSearchResult.results.length),resolveFilters(type),$scope.searchTermOneTime=q,$scope.filterOn=type?!0:!1,resolveRelatedDepartment(q),resolveSectionsForDisplay()}function resolveFilters(type){if(type)if("string"==typeof type)filters[type]=!0;else for(var i=0;i<type.length;i++)filters[type[i]]=!0}function resolveSectionsForDisplay(){($scope.totalCount>0||0===$scope.totalCount&&$scope.filterOn)&&!searchResponse.suggestionBasedResult&&($scope.showSearchResults=!0),($scope.totalCount>0||0===$scope.totalCount&&$scope.filterOn)&&searchResponse.suggestionBasedResult&&($scope.showSuggestedSearchResults=!0),0!==$scope.totalCount||$scope.filterOn||($scope.showZeroResultsFound=!0,$scope.showTimeseriesSearchSuggest=resolveTimeseriesSuggestion()),($scope.totalCount>0||$scope.filterOn)&&($scope.showFilters=filters.timeseries||isPrerender()?!1:!0)}function resolveTimeseriesSuggestion(){return filters.timeseries||isPrerender()?!1:searchResponse.timeseriesCount>0?!0:!1}function reLoad(){PageUtil.goToPage(searchResponse.suggestionBasedResult?"/search/"+searchResponse.suggestion:"/search/"+searchTerm),PageUtil.setUrlParam("type",resolveTypes(filters))}function toggleFilter(type){filters[type]=!filters[type],reLoad()}function resolveTypes(filters){var activeFilters=[];for(type in filters)filters[type]&&activeFilters.push(type);var result=activeFilters.length>0?activeFilters:null;return console.log(result),result}function isActive(type){var result=filters[type];return result}function resolveRelatedDepartment(searchTerm){$log.debug("Resolving related department for "+searchTerm);var departmentCode;searchTerm=searchTerm.toLowerCase();for(var i=0;i<departmentHandoff.length;i++)for(var x=0;x<departmentHandoff[i].length;x++)if(departmentHandoff[i][x]===searchTerm)return departmentCode=departmentHandoff[i][0],$scope.relatedDepartment=relatedDepartments[departmentCode],void $log.debug("Department resolved as "+departmentCode);$scope.relatedDepartment=void 0}function watchResize(){angular.element($window).bind("resize",function(){resolvePaginatorLinkCount(),$scope.$apply()})}function resolvePaginatorLinkCount(){$scope.paginatorLinks=$window.innerWidth<500?5:$window.innerWidth<600?6:$window.innerWidth<700?7:$window.innerWidth<920?8:$window.innerWidth<980?9:10}function isShowLozenge(item){return"home"!=item.type&&"timeseries"!=item.type}function isPrerender(){return PageUtil.isPrerender()}function link(url){return StringUtil.startsWith(url,"/")?"#!"+url:url}var searchTerm=$scope.searchTerm=$routeParams.searchTerm,page=$routeParams.page;if(!searchTerm)return void($scope.noSearchTerm=!0);if(!searchResponse||!searchResponse.contentSearchResult.results)return void($rootScope.error=500);$scope.searchResponse=searchResponse;var type=$scope.type=$routeParams.type,filters={},departmentHandoff=[["dfe","education","gcse","a level","degree","nvq","school","college","university","national curriculum","qualification","teacher training","pupil absence","exclusions","school workforce","key stage"],["bis","business","apprenticeship","building","construction","higher education","trade union","enterprise"],["decc","energy","solar","coal","oil","gas","electricity","fuel poverty","renewables","greenhouse gas"],["defra","agriculture","farming","air quality","emissions","recycling","food","conservation","biodiversity","animals","wildlife","ecosystem"],["hmrc","tax","benefit","paye","national insurance","vat","tabacco"],["ho","arrests","asylum","immigration","firearm","crime","visa","police","terrorism","detention"],["dclg","revenue expenditure","local authority","council tax","homelessness","social housing","help to buy"],["dcms","charitable giving"],["dft","bus","vehicle","driver","rider","freight","vehicle licensing","road","biofuel","road casualties","traffic, congestion","road conditions"],["dwp","national insurance","social fund","child maintenance","lone parents","child support agency","benefit fraud","universal credit"],["dh","abortion"],["fc","woodland","timber","forestry","nursery"],["mod","defence","armed forces","military","veterans","reserves","war pensions"],["moj","criminal justice","prison","offender","civil justice","knife possession","legal aid","youth custody","probation","reoffence","asbo","prison population"],["nhs","a&e","dementia","waiting times","hospital","critical care","inpatient","outpatient","ambulance"],["tis","insolvency"],["wg","wales","welsh"],["sg","scotland","scottish"],["nie","northern ireland","irish"]],relatedDepartments={dfe:{departmentName:"the Department for Education",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-education",departmentLogo:"ui/img/dfe.png"},bis:{departmentName:"the Department for Business, Innovation & Skills",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-business-innovation-skills",departmentLogo:"ui/img/bis.png"},decc:{departmentName:"the Department of Energy & Climate Change",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-of-energy-climate-change",departmentLogo:"ui/img/decc.png"},defra:{departmentName:"the Department for Environment, Food & Rural Affairs",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-environment-food-rural-affairs",departmentLogo:"ui/img/defra.png"},hmrc:{departmentName:"HM Revenue & Customs",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=hm-revenue-customs",departmentLogo:"ui/img/hmrc.png"},ho:{departmentName:"the Home Office",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=home-office",departmentLogo:"ui/img/ho.png"},dclg:{departmentName:"the Department for Communities & Local Government",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-communities-and-local-government",departmentLogo:"ui/img/dclg.png"},dcms:{departmentName:"the Department for Culture, Media & Sports",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-culture-media-sport",departmentLogo:"ui/img/dcms.png"},dft:{departmentName:"the Department for Transport",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-transport",departmentLogo:"ui/img/dft.png"},dwp:{departmentName:"the Department for Work & Pensions",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-for-work-pensions",departmentLogo:"ui/img/dwp.png"},dh:{departmentName:"the Department of Health",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=department-of-health",departmentLogo:"ui/img/dh.png"},fc:{departmentName:"the Forestry Commission",departmentLink:"http://www.forestry.gov.uk/",departmentLogo:"ui/img/fc.png"},mod:{departmentName:"the Ministry of Defence",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=home-office",departmentLogo:"ui/img/mod.png"},moj:{departmentName:"the Ministry of Justice",departmentLink:"https://www.gov.uk/government/statistics?keywords=&topics%5B%5D=all&departments%5B%5D=ministry-of-defence",departmentLogo:"ui/img/moj.png"},nhs:{departmentName:"the NHS",departmentLink:"https://www.gov.uk/government/statistics?departments%5B%5D=national-health-service",departmentLogo:"ui/img/nhs.png"},tis:{departmentName:"the Insolvency Service",departmentLink:"https://www.gov.uk/government/statistics?departments%5B%5D=insolvency-service",departmentLogo:"ui/img/tis.png"},wg:{departmentName:"the Welsh Government",departmentLink:"http://wales.gov.uk",departmentLogo:"ui/img/wg.png"},sg:{departmentName:"the Scottish Government",departmentLink:"http://www.scotland.gov.uk/Topics/Statistics",departmentLogo:"ui/img/sg.png"},nie:{departmentName:"the Northern Ireland Executive",departmentLink:"http://www.northernireland.gov.uk/",departmentLogo:"ui/img/nie.png"}};
resolvePaginatorLinkCount(),watchResize(),initialize(searchTerm,type,page),angular.extend($scope,{toggleFilter:toggleFilter,isActive:isActive,isShowLozenge:isShowLozenge,isPrerender:isPrerender,link:link})}angular.module("onsTemplates").controller("SearchController",["$scope","$rootScope","$window","$log","PageUtil","StringUtil","searchResponse","$routeParams",SearchController])}(),function(){"use strict";function ContactUsController($scope){$scope.breadcrumb={parent:[],current:"About us"}}angular.module("onsTemplates").controller("AboutCtrl",["$scope",ContactUsController])}(),function(){"use strict";function AccessibilityCtrl($scope){$scope.breadcrumb={parent:[],current:"Accessibility"}}angular.module("onsTemplates").controller("AccessibilityCtrl",["$scope",AccessibilityCtrl])}(),function(){function ArticleController($scope){$scope.header="Expert Analysis",$scope.contentType="article",$scope.sidebar=!0,$scope.sidebarUrl="app/templates/content/contentsidebar.html"}angular.module("onsTemplates").controller("ArticleCtrl",["$scope",ArticleController])}(),function(){function BulletinController($scope){$scope.header="Statistical bulletin",$scope.contentType="bulletin",$scope.sidebar=!0,$scope.sidebarUrl="app/templates/content/contentsidebar.html"}angular.module("onsTemplates").controller("BulletinCtrl",["$scope",BulletinController])}(),function(){"use strict";function LoaderCtrl($scope,$log,DataLoader){DataLoader.load("/data/releases").then(function(data){$log.debug("Loaded data"),$scope.calendarData=data})}function CalendarCtlr($scope){$scope.breadcrumb={parent:[],current:"Release calendar"}}angular.module("onsTemplates").controller("LoaderCtrl",["$scope","$log","DataLoader",LoaderCtrl]).controller("CalendarCtlr",["$scope","$log",CalendarCtlr])}(),function(){function CollectionController($location,$log,DataLoader,PageUtil){function loadContent(searchTerm){DataLoader.load("/data"+searchTerm).then(function(data){collection.content=data})}function searchCollection(loc,type,pageNumber){$log.debug("Searching for collections from: "+searchTerm);var collectionSearchString="?loc="+loc+(contentType?"&contentType="+contentType:"")+"&page="+pageNumber;DataLoader.load("/collectiontaxonomyfilesystem"+collectionSearchString).then(function(data){collection.searchResponse=data,collection.pageCount=Math.ceil(data.numberOfResults/10)})}function resolveContentType(contentType){switch(contentType){case"bulletins":return"statistical bulletins";default:return contentType}}function isLoading(){return collection.searchTerm&&collection.searchResponse}$log.debug("CollectionCtrl invoked");var collection=this,url=$location.$$path,lastIndex=url.lastIndexOf("/"),searchTerm=url.substr(0,lastIndex),page=PageUtil.getUrlParam("page");page=page||1;var contentType=PageUtil.getUrlParam("contentType");searchTerm&&contentType&&(collection.contentType=resolveContentType(contentType),searchCollection(searchTerm,contentType,page),loadContent(searchTerm),angular.extend(collection,{isLoading:isLoading}))}angular.module("onsTemplates").controller("CollectionCtrl",["$location","$log","DataLoader","PageUtil",CollectionController])}(),function(){angular.module("onsTemplates").controller("ContentCtrl",["$scope","$location","$log","DataLoader",function($scope,$location,$log,DataLoader){function loadRelatedBulletins(data){var dataPath="/data",bulletins=data.relatedBulletins;if(data.relatedBulletinData=[],null!=bulletins)for(var i=0;i<bulletins.length;i++){$scope.content.hasRelatedBulletins=!0;var bulletin=bulletins[i],relatedBulletinPath=dataPath+bulletin.uri;DataLoader.load(relatedBulletinPath).then(function(relatedBulletin){$log.debug("Loaded related bulletin: ",relatedBulletinPath," ",relatedBulletin),data.relatedBulletinData.push(relatedBulletin)})}}$scope.content=$scope.taxonomy.data,$scope.content.hasRelatedBulletins=!1,loadRelatedBulletins($scope.content),$scope.scroll=function(){anchorSmoothScroll.scrollTo($location.hash())}}]).directive("onsContent",function(){return{restrict:"E",templateUrl:"app/templates/content/content.html"}})}(),function(){"use strict";function ContactUsController($scope){$scope.breadcrumb={parent:[],current:"Copyright"}}angular.module("onsTemplates").controller("CopyrightCtrl",["$scope",ContactUsController])}(),function(){angular.module("onsTemplates").controller("ReleaseCtrl",["$scope","$log","Taxonomy","$location",function($scope){$scope.releaseData=$scope.taxonomy.data,console.log($scope.releaseData)}])}(),function(){"use strict";function DatasetController($scope,Downloader){function initialize(){for(var download=data.download,i=0;i<download.length;i++)if(download[i].cdids){ctrl.timeseries=!0,ctrl.timeseriesItem=download[i];break}}function downloadXls(){download("xlsx")}function downloadCsv(){download("csv")}function download(type){var downloadRequest={type:type,cdidList:ctrl.timeseriesItem.cdids},fileName=ctrl.timeseriesItem.title+"."+downloadRequest.type;Downloader.downloadFile(downloadRequest,fileName)}var ctrl=this;ctrl.sidebarUrl="app/templates/dataset/datasetsidebar.html";var data=ctrl.data=$scope.taxonomy.data;ctrl.timeseries=!1,ctrl.timeseriesItem,initialize(),angular.extend(ctrl,{downloadXls:downloadXls,downloadCsv:downloadCsv})}angular.module("onsTemplates").controller("DatasetController",["$scope","Downloader",DatasetController])}(),function(){"use strict";function ContactUsController($scope){$scope.breadcrumb={parent:[],current:"Contact Us"}}angular.module("onsTemplates").controller("ContactUsCtrl",["$scope",ContactUsController])}(),function(){"use strict";function LocalStatsCtlr($scope){$scope.breadcrumb={parent:[],current:"Local statistics"}}angular.module("onsTemplates").controller("LocalStatsCtlr",["$scope",LocalStatsCtlr])}(),function(){"use strict";function AlphaPageCtlr($scope){$scope.breadcrumb={parent:[],current:"Prototype website"}}angular.module("onsTemplates").controller("AlphaPageCtlr",["$scope",AlphaPageCtlr])}(),function(){"use strict";function ContactUsController($scope){$scope.breadcrumb={parent:[],current:"Methodology"}}angular.module("onsTemplates").controller("MethodologyCtrl",["$scope",ContactUsController])}(),function(){"use strict";function NationalStatsCtlr($scope){$scope.breadcrumb={parent:[],current:"National Statistics"}}angular.module("onsTemplates").controller("NationalStatsCtlr",["$scope",NationalStatsCtlr])}(),function(){"use strict";function ContactUsController($scope){$scope.breadcrumb={parent:[],current:"Previous Sample Page"}}angular.module("onsTemplates").controller("PreviousCtrl",["$scope",ContactUsController])}(),function(){"use strict";function ContactUsController($scope){$scope.breadcrumb={parent:[],current:"Cookies and privacy"}}angular.module("onsTemplates").controller("PrivacyCtrl",["$scope",ContactUsController])}(),function(){"use strict";function SurveyCtlr($scope){$scope.breadcrumb={parent:[],current:"Survey"}}angular.module("onsTemplates").controller("SurveyCtrl",["$scope",SurveyCtlr])}(),function(){"use strict";function ModalController(ipCookie,PageUtil){function isAccepted(){var accepted=ipCookie("onsAlphaDisclaimer");return accepted}function acceptDisclaimer(){ipCookie("onsAlphaDisclaimer",!0),modal.showModal=!1}var modal=this;modal.showModal=isAccepted()?!1:!0,modal.showModal=PageUtil.isPrerender()?!1:modal.showModal,angular.extend(modal,{acceptDisclaimer:acceptDisclaimer})}angular.module("onsTemplates").controller("ModalController",["ipCookie","PageUtil",ModalController])}(),function(){var onsTemplates=angular.module("onsTemplates");onsTemplates.directive("onsHeader",function(){return{restrict:"E",templateUrl:"app/partials/header/header.html"}})}(),function(){var onsTemplates=angular.module("onsTemplates");onsTemplates.directive("onsFooter",function(){return{restrict:"E",templateUrl:"app/partials/footer/footer.html"}})}(),function(){"use strict";function NavigationController($scope,$rootScope){function toggleSearch(){navigation.hideSearch=!navigation.hideSearch,navigation.hideSearch||hideMenu()}function watchLocation(){$rootScope.$on("$locationChangeSuccess",function(){hideMenu(),showSearch()})}function isMobileMenuVisible(){return $scope.w_nav?$scope.w_nav.showOnMobile:!1}function watchMenu(){$scope.$watch("w_nav.showOnMobile",function(){isMobileMenuVisible()&&(navigation.hideSearch=!0)})}function hideMenu(){$scope.w_nav.showOnMobile=!1}function showSearch(){navigation.hideSearch=!1}var navigation=this;navigation.hideSearch=!1,watchLocation(),watchMenu(),angular.extend(navigation,{toggleSearch:toggleSearch})}angular.module("onsTemplates").controller("NavigationController",["$scope","$rootScope",NavigationController])}(),function(){"use strict";angular.module("onsTemplates").directive("searchBox",["$location","$route","PageUtil","StringUtil",function($location,$route,PageUtil,StringUtil){function SearchBox($scope,$rootScope){function clearOnPageChange(){$rootScope.$on("$locationChangeSuccess",function(){StringUtil.startsWith($location.path(),"/search")||($scope.searchTerm="")})}$scope.autoCompleteLimit=$rootScope.onsAlphaConfiguration.autoCompleteLimit,clearOnPageChange(),$scope.goToSearch=function(searchTerm){if(searchTerm){var currentPath=$location.url();currentPath==="/search/"+searchTerm?$route.reload():($location.path("/search/"+searchTerm),$location.search("type",null))}},$scope.getStaticFormAction=function(){var staticSearchForm="/static/search";return PageUtil.isPrerender()?staticSearchForm:""}}return{restrict:"E",replace:!0,templateUrl:"app/partials/searchbox/searchbox.html",controller:["$scope","$rootScope",SearchBox]}}])}(),function(){"use strict";angular.module("onsTemplates").directive("latestBulletins",function(){return{restrict:"E",templateUrl:"app/partials/latest-bulletins/latest-bulletins.html"}})}(),function(){"use strict";angular.module("onsTemplates").directive("relatedArticles",function(){return{restrict:"E",templateUrl:"app/partials/related-articles/related-articles.html"}})}(),function(){"use strict";function ContactDetails(){return{restrict:"E",templateUrl:"app/partials/contact-details/contactdetails.html"}}angular.module("onsTemplates").directive("contactDetails",ContactDetails)}(),function(){"use strict";angular.module("onsTemplates").directive("socialLinks",function(){function SocialLinksController($scope,$location){function getAbsoluteUrl(){var absUrl=encodeURIComponent($location.absUrl());return absUrl}function getFbAbsoluteUrl(){var fbUrl=$location.absUrl().replace("#!","?onsfb");return fbUrl}angular.extend($scope,{getAbsoluteUrl:getAbsoluteUrl,getFbAbsoluteUrl:getFbAbsoluteUrl})}return{restrict:"E",templateUrl:"app/partials/social-links/social-links.html",controller:["$scope","$location",SocialLinksController]}})}(),function(){"use strict";angular.module("onsTemplates").directive("onsToolsPane",function(){return{restrict:"E",templateUrl:"app/partials/tools-pane/tools-pane.html"}})}(),function(){"use strict";function BreadCrumbDirective($location){return{scope:{data:"="},restrict:"E",controller:function($scope){$scope.getPath=function(){return $location.$$path},$scope.getParentOf=function(index){for(var uri=($location.$$path,""),i=0;index>i;i++)uri+="/"+$scope.data.parent[i].fileName;return uri}},templateUrl:"app/components/breadcrumb/breadcrumb.html"}}angular.module("onsComponents").directive("onsBreadcrumb",["$location",BreadCrumbDirective])}(),function(){"use strict";function Nav($window,$rootScope){function NavController($scope){function init(){resolveScreenType(),listenResize(),watchLocation(),$scope.navWidgetVar&&($scope.$parent[$scope.navWidgetVar]=navigation)}function watchLocation(){$rootScope.$on("$locationChangeSuccess",function(){for(var i=0;i<items.length;i++)items[i].resolveClass(),items[i].expanded=!1})}function toggleMobileMenu(){navigation.showOnMobile=!navigation.showOnMobile}function listenResize(){angular.element($window).bind("resize",function(){resolveScreenType(),$scope.$apply()})}function resolveScreenType(){navigation.mobile=$window.innerWidth<800?!0:!1}function registerItem(item){items.push(item)}var navigation=this;navigation.activeClass=$scope.activeClass,navigation.showOnMobile=!1,navigation.mobile=!1;var items=[];init(),angular.extend(navigation,{toggleMobileMenu:toggleMobileMenu,registerItem:registerItem})}return{restrict:"A",scope:{navWidgetVar:"@",activeClass:"@navActiveClass"},controller:NavController,controllerAs:"navigation"}}function NavItem($location,StringUtil){function NavItemLink(scope,element,attrs,navigation){function initialize(){navigation.registerItem(scope),bindClick(),resolveClass()}function resolveClass(){isCurrentPage()?element.addClass(navigation.activeClass):element.removeClass(navigation.activeClass)}function bindClick(){element.bind("click",function(e){scope.expandable?isMobile()&&(scope.expanded=!scope.expanded,scope.$apply()):e.stopPropagation()})}function isMobile(){return navigation.mobile}function isCurrentPage(){return scope.url&&StringUtil.startsWith($location.$$path,scope.url)}scope.url=attrs.onsNavItem||"",scope.currentPage=!1,scope.expanded=!1,initialize(),angular.extend(scope,{resolveClass:resolveClass})}function NavItemController($scope){function isExpanded(){return $scope.expanded}var navItem=this;angular.extend(navItem,{isExpanded:isExpanded})}return{restrict:"A",require:"^onsNav",scope:{expandable:"=?"},controller:NavItemController,controllerAs:"navItem",link:NavItemLink}}function NavCollapseClass(){function NavCollapseClassLink(scope,element,attrs,expandable){function watchExpand(){scope.$watch(expandable.isExpanded,function(){expandable.isExpanded()?element.removeClass(collapseClass):element.addClass(collapseClass)})}var collapseClass=scope.collapseClass=attrs.onsNavCollapseClass;collapseClass&&watchExpand()}return{restrict:"A",require:"^onsNavItem",scope:{},link:NavCollapseClassLink}}function NavExpandClass(){function NavExpandClassLink(scope,element,attrs,navItem){function watchExpand(){scope.$watch(navItem.isExpanded,function(newValue){newValue?element.addClass(expandClass):element.removeClass(expandClass)})}var expandClass=scope.expandClass=attrs.onsNavExpandClass;expandClass&&watchExpand()}return{restrict:"A",require:"^onsNavItem",link:NavExpandClassLink}}function NavMobile(){function NavMobileLink(scope,element,attrs,navigation){function isMobile(){return navigation.mobile}angular.extend(scope,{isMobile:isMobile})}return{restrict:"A",require:"^onsNav",link:NavMobileLink,transclude:!0,template:'<span ng-transclude ng-show="isMobile()"></span>'}}function NavDesktopDirective(){function NavDesktopLink(scope,element,attrs,navigation){function isDesktop(){return!navigation.mobile}angular.extend(scope,{isDesktop:isDesktop})}return{restrict:"A",require:"^onsNav",link:NavDesktopLink,transclude:!0,template:'<span ng-transclude ng-show="isDesktop()"></span>'}}angular.module("onsNavigation",[]).directive("onsNav",["$window","$rootScope",Nav]).directive("onsNavItem",["$location","StringUtil",NavItem]).directive("onsNavCollapseClass",[NavCollapseClass]).directive("onsNavExpandClass",[NavExpandClass]).directive("onsNavMobile",[NavMobile]).directive("onsNavDesktop",[NavDesktopDirective])}(),function(){"use strict";function Autocomplete($http,$rootScope,$log){function AutocompleteLink(scope){function initialize(){setWidth(input.outerWidth()),watchInputWidth(),watchInputValue(),angular.element("#onsAutocompleteDiv").bind("click",function(event){event.stopPropagation()}),input.bind("click",function(event){search(scope.searchTerm),event.stopPropagation(),scope.$apply()}),angular.element("html").bind("click",function(){hide(),scope.$apply()})}function watchInputValue(){scope.$watch(function(){return input.val()},function(newValue){scope.searchTerm=newValue,isMinimumEntered()?search(newValue):(clearData(),hide())})}function watchInputWidth(){scope.$watch(function(){return input.outerWidth()},function(newValue){scope.style={width:newValue}})}function search(key){if(firstTime)return void(firstTime=!1);if(isMinimumEntered()){var url=searchUrl+"?"+searchParam+"="+key;$log.debug("Autocomplete: Searching for: ",url),$http.get(url).success(function(data){setData(data),show()}).error(function(){clearData(),hide()})}}function clearData(){parent[dataVar]={}}function setData(data){parent[dataVar]=data}function setWidth(width){contentContainer.css({width:width})}function hide(){scope.visible=!1}function show(){isMinimumEntered()&&(scope.visible=!0)}function isMinimumEntered(){return scope.searchTerm.length>=minChars}if(!scope["for"])throw'Input element not sepecified for autocomplete, use for="<id>"';var minChars=+(scope.minChars||3),searchUrl=scope.searchUrl||"search",searchParam=scope.searchParam||"term",dataVar=scope.dataVar||"data",parent=scope.$parent,contentContainer=angular.element(""),input=scope.input=angular.element("#"+scope["for"]),firstTime=!0;scope.visible=!1,initialize(),angular.extend(scope,{hide:hide})}return{restrict:"A",transclude:!0,scope:{"for":"@",minChars:"@",searchUrl:"@",searchParam:"@",dataVar:"@"},link:AutocompleteLink,template:'<div id="onsAutocompleteDiv" ng-style="style" ng-transclude ng-show="visible" class="autocomplete"></div>'}}angular.module("onsAutocomplete",[]).directive("onsAutocomplete",["$http","$rootScope","$log",Autocomplete])}(),function(){"use strict";function Paginator($location,$routeParams){function PaginatorController($scope){function init(){paginator.start=getStart(),paginator.end=getEnd(),paginator.show=$scope.pageCount>1}function watchPageCount(){$scope.$watch("pageCount",function(){init()})}function watchMaxVisible(){$scope.$watch("maxVisible",function(newValue){maxVisible=newValue,init()})}function getStart(){if($scope.pageCount<=maxVisible)return 1;var end=getEnd(),start=end-maxVisible+1;return start=start>0?start:1}function getEnd(){var max=$scope.pageCount;if(maxVisible>=max)return max;var end=currentPage+Math.ceil(maxVisible/2);return end=end>max?max:end,end=maxVisible>end?maxVisible:end}function selectPage(index){gotoPage(index),init()}function next(){gotoPage(currentPage+1),init()}function prev(){gotoPage(currentPage-1),init()}function getLinkTarget(index){var target="";return target=$scope["static"]?"/static"+getPath(index):""}function gotoPage(page){$location.path(getPath(page)),currentPage=page}function getPath(page){var path=$location.path(),newPath="";return console.log("Path:"+path+" currentPage:"+currentPage),path.indexOf("/"+PAGE_PARAM+"/"+currentPage)>-1?(console.log("Page available"),newPath=path.replace(PAGE_PARAM+"/"+currentPage,PAGE_PARAM+"/"+page)):newPath=path+"/"+PAGE_PARAM+"/"+page,console.log("New path:"+newPath),newPath}function isCurrent(index){return currentPage===index}function isNextVisible(){return currentPage<$scope.pageCount}function isPrevVisible(){return currentPage>1}var paginator=this,PAGE_PARAM="page",maxVisible=$scope.maxVisible||10,currentPage=$scope.currentPage=+$routeParams[PAGE_PARAM]||1;paginator.show,paginator.start,paginator.end,init(),watchPageCount(),watchMaxVisible(),angular.extend(paginator,{isPrevVisible:isPrevVisible,isNextVisible:isNextVisible,isCurrent:isCurrent,prev:prev,next:next,selectPage:selectPage,getLinkTarget:getLinkTarget})}return{restrict:"E",templateUrl:"app/components/paginator/paginator.html",scope:{pageCount:"=",maxVisible:"=","static":"=?"},controller:PaginatorController,controllerAs:"paginator"}}function rangeFilter(){return function(input,start,end){for(var start=parseInt(start),end=parseInt(end),i=start;end>=i;i++)input.push(i);return input}}angular.module("onsPaginator",[]).directive("onsPaginator",["$location","$routeParams",Paginator]).filter("range",rangeFilter)}(),function(){"use strict";function ToggleService(){function registerToggleable(toggleable){toggleables[toggleable.key]=toggleable}function toggle(key){toggleables[key].toggle()}function isVisible(key){var pane=toggleables[key];return pane?pane.visible:!1}var service=this,toggleables={};angular.extend(service,{registerToggleable:registerToggleable,toggle:toggle,isVisible:isVisible})}function Toggler(toggleService){function TogglerLink(scope,elem,attrs){function bindClick(){elem.bind("click",function(){toggleService.toggle(attrs.toggler),scope.$apply()})}function isVisible(){return toggleService.isVisible(toggler.key)}var toggler=scope;toggler.key=attrs.toggler,bindClick(),scope.togglerWidgetVar&&(scope.$parent[scope.togglerWidgetVar]=toggler),angular.extend(toggler,{isVisible:isVisible})}return{restrict:"A",scope:{togglerWidgetVar:"@"},link:TogglerLink}}function Toggleable(toggleService){return{restrict:"A",transclude:!0,scope:{},link:function(scope,elem,attrs){scope.toggle=function(){scope.visible=!scope.visible},scope.key=attrs.toggleable,toggleService.registerToggleable(scope)},template:'<div ng-transclude ng-show="visible"></div>'}}angular.module("onsToggler",[]).service("toggleService",ToggleService).directive("toggler",["toggleService",Toggler]).directive("toggleable",["toggleService",Toggleable])}(),function(){"use strict";function AccordionDirective(){return{restrict:"E",scope:{multiple:"=?"},controller:AccordionController,controllerAs:"accordion"}}function AccordionController($scope){function init(){accordion.multiple=$scope.multiple,accordion.panes=[]}function addPane(pane){0===accordion.panes.length&&(pane.closed||toggle(pane)),accordion.panes.push(pane)}function toggle(pane){accordion.multiple||angular.forEach(accordion.panes,function(p){p.selected=!1}),pane.selected=!pane.selected}var accordion=this;init(),angular.extend(accordion,{toggle:toggle,addPane:addPane})}function AccordionitemDirective(){return{require:"^onsAccordion",restrict:"E",transclude:!0,scope:{header:"@",closed:"=?"},link:AccordionItemLink,templateUrl:"app/components/accordion/accordionitem.html"}}function AccordionItemLink(scope,element,attrs,accordionCtrl){function init(){accordionCtrl.addPane(pane),scope.pane=pane}function toggle(){accordionCtrl.toggle(pane)}var pane=scope;init(),angular.extend(scope,{toggle:toggle})}angular.module("onsAccordion",[]).directive("onsAccordion",AccordionDirective).directive("onsAccordionItem",AccordionitemDirective),AccordionController.$inject=["$scope"]}(),function(){"use strict";function Tabs(){function TabsController($scope){function select(key){for(var p in panes)panes.hasOwnProperty(p)&&(panes[p].selected=!1);var selectedPane=panes[key];selectedPane.selected=!0,$scope.tabsActiveVar&&($scope.$parent[$scope.tabsActiveVar]=selectedPane.key)}function isSelected(key){alert(key);var pane=panes[key];return pane?pane.selected:!1}function registerTabPane(pane){panes[pane.key]=pane,0===numberOfPanes&&select(pane.key),numberOfPanes++}var tabs=this,panes=tabs.panes={},numberOfPanes=this.numberOfPanes=0;angular.extend(tabs,{registerTabPane:registerTabPane,select:select,isSelected:isSelected})}return TabsController.$inject=["$scope"],{restrict:"A",scope:{tabsActiveVar:"@"},controller:TabsController,controllerAs:"tabs"}}function TabControl(){return{require:"^onsTabs",restrict:"A",scope:{},link:function(scope,element,attrs,tabsController){function bindClick(){element.bind("click",function(){scope.$apply(function(){tabsController.select(scope.key)})})}if(scope.key=attrs.onsTabControl,!scope.key)throw"tab control key can not be empty";bindClick()}}}function Tab(){return{require:"^onsTabs",restrict:"A",scope:{},transclude:!0,replace:!0,link:function(scope,element,attrs,tabsController){if(scope.key=attrs.onsTab,!scope.key)throw'tab key can not be empty"';tabsController.registerTabPane(scope)},template:'<div ng-transclude ng-show="selected"> </div>'}}angular.module("onsTabs",[]).directive("onsTabs",Tabs).directive("onsTabControl",TabControl).directive("onsTab",Tab)}(),function(){"use strict";function Loading(){return{restrict:"E",replace:!0,scope:{condition:"=?","class":"@"},link:function(scope){"undefined"==typeof scope.condition&&(scope.condition=!0)},template:' <div style="display:flex" ng-class="class" ng-if="condition" ><img style="margin:auto" width="14" height="14" src="/ui/img/loading.gif" width:"32" height="32" alt="Loading..." class="media__img"></div>'}}angular.module("onsLoading",[]).directive("onsLoading",[Loading])}(),function(){"use strict";function InfoTooltip(){return{restrict:"E",scope:{tipClass:"@",tip:"@"},template:'<span ng-if="tip" tabindex="0" ng-class="tipClass" class="tooltips icon-info-circled icon--warm icon--inline tooltipstered"><span ng-bind-html="tip" class=""></span></span>'}}function HelpTooltip(){return{restrict:"E",scope:{tipClass:"@",tip:"@"},template:'<span ng-if="tip" tabindex="0" ng-class="tipClass" class="tooltips icon-help-circled icon--blue-alt icon--inline tooltipstered"><span ng-bind-html="tip" class=""></span></span>'}}angular.module("onsTooltip",[]).directive("onsInfoTooltip",[InfoTooltip]).directive("onsHelpTooltip",[HelpTooltip])}(),function(){"use strict";function DoubleTapService(){function registerDoubleTapItem(item){items.push(item)}function clearTaps(){for(var i=0;i<items.length;i++)items[i].tapped=!1}var service=this,items=[];angular.extend(service,{registerDoubleTapItem:registerDoubleTapItem,clearTaps:clearTaps})}function DoubleTapToGo($document,$window,$log,DoubleTapService){function DoubleTapToGoLink(scope,element){var window=$window,navigator=$window.navigator;("ontouchstart"in window||navigator.msMaxTouchPoints||navigator.userAgent.toLowerCase().match(/windows phone os 7/i))&&(DoubleTapService.registerDoubleTapItem(scope),scope.tapped=!1,element.bind("click",function(event){element[0]!=scope.tapped[0]?(event.preventDefault(),DoubleTapService.clearTaps(),scope.tapped=element):scope.tapped=!1}))}return{restrict:"A",link:DoubleTapToGoLink}}angular.module("onsDoubleTap",[]).service("DoubleTapService",DoubleTapService).directive("onsDoubleTap",["$document","$window","$log","DoubleTapService",DoubleTapToGo])}(),function(){"use strict";function SparkLine(){function SparkLineController($scope,$element,$window,$log){function watchData(){$scope.$watch("chartData",function(){$scope.chartData?(buildChart(sparkline.chartConfig,$scope.chartData,$scope.headline),sparkline.visible=!0):sparkline.visible=!1})}function watchWidth(){$scope.headline&&angular.element($window).bind("resize",function(){$log.debug("Resized:"+$window.innerWidth),resolveScreenSize(),$scope.$apply()})}function resolveScreenSize(){sparkline.chartConfig.options.chart.width=$window.innerWidth<900?175:350,$log.debug("chart width set to: "+sparkline.chartConfig.options.chart.width)}function buildChart(chartConfig,timeseries){function prepareData(){function tickInterval(length){return 20>=length?1:80>=length?4:240>=length?12:480>=length?48:960>=length?96:192}function formatData(timeseries){var current,i,data={values:[]};for(i=0;i<timeseries.length;i++)current=timeseries[i],data.values.push(enrichData(current));return data}function enrichData(timeseries){return timeseries.y=+timeseries.value,timeseries.name=timeseries.date,timeseries}chartConfig.series[0].data=formatData(timeseries).values,chartConfig.options.xAxis.tickInterval=tickInterval(timeseries.length)}prepareData()}var sparkline=this;sparkline.visible=!1,sparkline.chartConfig=getSparkline($scope.width,$scope.height),watchData(),$scope.headline&&resolveScreenSize(),watchWidth()}return{restrict:"E",scope:{chartData:"=",width:"=",height:"=",headline:"=?"},controller:SparkLineController,controllerAs:"sparkline",templateUrl:"app/components/sparkline/sparkline.html"}}function getSparkline(width,height){var data={options:{chart:{backgroundColor:null,borderWidth:0,type:"area",margin:[0,0,0,0],width:width,height:height,style:{overflow:"visible"},skipClone:!0},title:{text:""},subtitle:{text:"",y:110},credits:{enabled:!1},xAxis:{categories:[],labels:{formatter:function(){return this.isFirst?this.value:this.isLast?this.value:void 0},step:1},tickLength:0,lineColor:"transparent"},yAxis:{endOnTick:!1,startOnTick:!1,labels:{enabled:!1},title:{text:null},tickPositions:[0]},legend:{enabled:!1},tooltip:{enabled:!1},plotOptions:{series:{animation:!1,lineWidth:1,shadow:!1,states:{hover:{lineWidth:1}},marker:{radius:1,states:{hover:{radius:2}}},fillOpacity:.25,enableMouseTracking:!1},column:{negativeColor:"#910000",borderColor:"silver"}},exporting:{enabled:!1}},series:[{name:"",data:[],marker:{symbol:"circle",states:{hover:{fillColor:"#007dc3",radiusPlus:0,lineWidthPlus:0}}},dashStyle:"Solid"}]};return data}angular.module("onsSparkline",["highcharts-ng"]).directive("onsSparkline",["$log",SparkLine])}(),function(){"use strict";angular.module("onsComponents").directive("markdown",function(){var converter=new Showdown.converter;return{restrict:"A",scope:{link:"@"},template:"<p></p>",link:function(scope,element,attrs){attrs.$observe("link",function(link){var htmlText=converter.makeHtml(link);element.html(htmlText),element.find("blockquote").find("p").addClass("box--padded--highlight")})}}})}(),function(){function slice(){return function(arr,start,end){return arr.slice(start,end)}}function range(){return function(input,start,end){start=parseInt(start),end=parseInt(end);for(var i=start;end>=i;i++)input.push(i);return input}}function join(){return function(list,seperator,propertyName){if(seperator=seperator||"",!propertyName)return list.join(seperator);result="";for(var i=0;i<list.length-1;i++)result+=list[i][propertyName]+seperator;return result+=list[i][propertyName],result}}function charLimit(){return function(text,limit,overflowText){return text=text||"",limit=limit||text.length,overflowText=overflowText||"",text.length<=limit?text:text.substr(0,limit)+overflowText}}function rangeDate(){return function(input,min,max,property){for(var item,value,results=[],i=0;i<input.length;i++)item=input[i],value=item[property],min&&max?value>=min&&max>=value&&results.push(item):min?value>=min&&results.push(item):max?max>=value&&results.push(item):results.push(item);return results}}angular.module("onsFilters",[]).filter("slice",slice).filter("range",range).filter("rangeDate",rangeDate).filter("join",join).filter("charLimit",charLimit)}(),function(){"use strict";function PageUtil($location,$log,$anchorScroll){function getTitle(){return title}function setTitle(newTitle){title=newTitle}function getUrlParam(paramName){var params=$location.search();return params[paramName]}function setUrlParam(key,value){$location.search(key,value)}function getPage(){var path=$location.$$path,lastIndex=path.lastIndexOf("/"),parenPath=path.substring(lastIndex+1,path.length);return parenPath}function getPath(){return $location.path()}function getAbsoluteUrl(){return $location.absUrl()}function getUrl(){return $location.url()}function isPrerender(){return getAbsoluteUrl().indexOf("prerender=true")>-1}function scrollTo(id){$location.hash(id),$anchorScroll(),$location.hash(null)}function goToPage(path,replaceHistory){$log.debug("PageUtil: Going to page ",path," replace history:",replaceHistory),$location.url(path),replaceHistory&&$location.replace()}var pageUtil=this,title="Office For National Statistics";return angular.extend(pageUtil,{getTitle:getTitle,setTitle:setTitle,getUrlParam:getUrlParam,setUrlParam:setUrlParam,getPage:getPage,getPath:getPath,getUrl:getUrl,getAbsoluteUrl:getAbsoluteUrl,goToPage:goToPage,isPrerender:isPrerender,scrollTo:scrollTo}),pageUtil}function ArrayUtil(){function getFirst(array){return isNotEmpty(array)?array[0]:void 0}function getLast(array){return isNotEmpty(array)?array[array.length-1]:void 0}function isNotEmpty(array){return array&&array.length>0}function isEmpty(array){return!array||0===array.length}function toUnique(a){for(var c,b=a.length;c=--b;)for(;c--;)a[b]!==a[c]||a.splice(c,1)}var arrayUtil=this;return angular.extend(arrayUtil,{getLast:getLast,getFirst:getFirst,isNotEmpty:isNotEmpty,isEmpty:isEmpty,toUnique:toUnique}),arrayUtil}function StringUtil(){function startsWith(str,prefix){return str&&0!==str.length?0===str.indexOf(prefix,0):!1}function endsWith(str,suffix){return str&&0!==str.length?-1!==str.indexOf(suffix,str.length-suffix.length):!1}var stringUtil=this;return angular.extend(stringUtil,{startsWith:startsWith,endsWith:endsWith}),stringUtil
}var onsUtils=angular.module("onsUtils",[]);onsUtils.factory("PageUtil",["$location","$log","$anchorScroll",PageUtil]).factory("ArrayUtil",ArrayUtil).factory("StringUtil",StringUtil)}();